function exportJsonToFile() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = ss.getSheetByName("Data"); 
  if (!sheet) {
    throw new Error("指定されたシート名が存在しません。シート名を確認してください。");
  }

  const rows = sheet.getDataRange().getValues();
  const headers = rows.shift();

  // 各行を JSON オブジェクトに変換
  const dataArray = rows.map(row => {
    let obj = {};
    headers.forEach((header, i) => {
      setNestedValue(obj, header, row[i]);
    });
    return obj;
  });

  // ★ ここで固定情報を追加したオブジェクトを作る
  const result = {
    Name: "Address",  // 固定
    Version: "1.0",   // 固定
    Data: dataArray   // シートから作った配列
  };

  // JSON に変換
  const json = JSON.stringify(result, null, 2);

  // 保存先フォルダ
  const folderId = "YOUR_FOLDER_ID"; // ←置き換え
  const folder = DriveApp.getFolderById(folderId);

  // ファイル名
  const fileName = "export.json";

  // JSON をファイルに保存
  const blob = Utilities.newBlob(json, "application/json", fileName);
  folder.createFile(blob);

  Logger.log("JSON を書き出しました: " + fileName);
}